https://www.zhihu.com/question/29637351

socket 与 TCP/IP 之间是唇齿相依般的关系，联系紧密，先来看下维基百科对 socket 的定义。socket 是计算机网络中用于在节点内发送或接收数据的内部端点。
具体来说，它是网络软件 (协议栈) 中这个端点的一种表示，包含通信协议、目标地址、状态等，是系统资源的一种形式。它在网络中所处的位置大致就是下面的黑色部分，应用层与传输层之间。
其中的传输层就是 TCP/IP 所在的地方，而你平时通过代码编写的应用程序大多属于应用层范畴，socket 在这里起到就是连接应用层与传输层的作用。
socket 的诞生是为了应用程序能够更方便的将数据经由传输层来传输，所以它本质上就是对 TCP/IP 的运用进行了一层封装，然后应用程序直接调用 socket API 即可进行通信。那么它是如何工作的呢？
它分为 2 个部分，服务端需要建立 socket 来监听指定的地址，然后等待客户端来连接。而客户端则需要建立 socket 并与服务端的 socket 地址进行连接。

值得注意的是，传输的过程涉及到数据 Copy，不过这些 Copy 是必不可少的。其中的发送缓冲区和接收缓冲区就是套接字缓存 (socket buffer)。
连接使用完之后需要关闭，不过 TCP/IP 连接关闭过程比创建更复杂一些，次数多了一次，这就是经典的“四次握手”过程。
简单总结一下 socket。socket 是进程间数据传输的媒介，为了保证连接的可靠，你需要特别注意建立连接和关闭连接的过程。
为了确保准确、完整的数据传输，客户端和服务端来回进行了多次网络通信才得以完成连接的创建和关闭，这同时也是你在运用一个连接时所花费的额外成本。

链接：https://www.zhihu.com/question/29637351/answer/534704474


---关于socket阻塞与非阻塞情况下的recv、send、read、write返回值
#https://www.huaweicloud.com/articles/0906e8442277b117733fa2d95b26b158.html
【摘要】1、阻塞模式与非阻塞模式下recv的返回值各代表什么意思？有没有区别？（就我目前了解阻塞与非阻塞recv返回值没有区分，都是 <0：出错，=0：连接关闭，>0接收到数据大小，特别：返回值 <0时并且(errno == EINTR || errno == EWOULDBLOCK || errno == EAGAIN)的情况下认为连接是正常的，继续接收。只是阻塞模式下recv会阻塞着接收数据，非...
1、阻塞模式与非阻塞模式下recv的返回值各代表什么意思？有没有区别？（就我目前了解阻塞与非阻塞recv返回值没有区分，都是 <0：出错，=0：连接关闭，>0接收到数据大小，特别：返回值 <0时并且(errno == eintr || errno == ewouldblock || errno == eagain)的情况下认为连接是正常的，继续接收。只是阻塞模式下recv会阻塞着接收数据，非阻塞模式下如果没有数据会返回，不会阻塞着读，因此需要 循环读取< span>

2、阻塞模式与非阻塞模式下write的返回值各代表什么意思？有没有区别？

阻塞与非阻塞write返回值没有区分，都是 <0：出错，=0：连接关闭，>0发送数据大小，特别：返回值 <0时并且(errno == eintr || errno == ewouldblock || errno == eagain)的情况下认为连接是正常的，继续发送。只是阻塞模式下write会阻塞着发送数据，非阻塞模式下如果暂时无法发送数据会返回，不会阻塞着 write，因此需要循环发送< span>

3、阻塞模式下read返回值 < 0 && errno != eintr && errno != ewouldblock && errno != eagain时，连接异常，需要关闭，read返回值 < 0 && (errno == eintr || errno == ewouldblock || errno == eagain)时表示没有数据，需要继续接收，如果返回值大于0表示接送到数据。 < span>

非阻塞模式下read返回值 < 0表示没有数据，= 0表示连接断开，> 0表示接收到数据。 

这2种模式下的返回值是不是这么理解，有没有跟详细的理解或跟准确的说明？ 

4、阻塞模式与非阻塞模式下是否send返回值 < 0 && (errno == eintr || errno == ewouldblock || errno == eagain)表示暂时发送失败，需要重试，如果send返回值 <= 0, && errno != eintr && errno != ewouldblock && errno != eagain时，连接异常，需要关闭，如果send返回值 > 0则表示发送了数据？send的返回值是否这么理解，阻塞模式与非阻塞模式下send返回值=0是否都是发送失败，还是那个模式下表示暂时不可发送，需要 重发？

转载于:https://blog.51cto.com/laokaddk/1054135
